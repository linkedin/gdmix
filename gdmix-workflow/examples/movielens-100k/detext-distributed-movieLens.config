{
    "output_dir":"movieLens/distributed-detext-training",
    "fixed_effect_config":{
        "name":"global",
        "model_type":"detext",
        "ftr_ext":"cnn",
        "elem_rescale":true,
        "ltr_loss_fn":"pointwise",
        "init_weight":"0.1",
        "learning_rate":"0.002",
        "num_classes":"1",
        "max_len":"16",
        "min_len":"3",
        "num_filters":"50",
        "num_train_steps":"1000",
        "num_units":"64",
        "optimizer":"bert_adam",
        "pmetric":"auc",
        "all_metric":"auc",
        "steps_per_stats":"10",
        "steps_per_eval":"100",
        "train_batch_size":"64",
        "test_batch_size":"64",
        "use_deep":true,
        "vocab_file":"movieLens/detext/vocab.txt",
        "resume_training":false,
        "query":"query",
        "wide_ftrs":"wide_ftrs",
        "doc_text":"doc_title",
        "usr_text":"usr_headline",
        "wide_ftrs_sp_idx":"wide_ftrs_sp_idx",
        "wide_ftrs_sp_val":"wide_ftrs_sp_val",
        "num_wide_sp":"45",
        "train_file":"movieLens/detext/trainingData/train_data.tfrecord",
        "dev_file":"movieLens/detext/validationData/test_data.tfrecord",
        "test_file":"movieLens/detext/validationData/test_data.tfrecord",
        "metadata_file":"movieLens/per-user/metadata/tensor_metadata.json",
        "input_column_names":{
            "label":"response",
            "sample_id":"uid",
            "sample_weight":"weight",
            "feature_bag":"global"
        },
        "output_column_name":"predictionScore",
        "keep_checkpoint_max":"1"
    },
    "random_effect_config":[
        {
            "name":"per-user",
            "action":"train",
            "model_type":"logistic_regression",
            "partition_entity":"user_id",
            "train_data_path":"movieLens/per_user/trainingData",
            "validation_data_path":"movieLens/per_user/validationData",
            "feature_file":"movieLens/per_user/featureList/per_user",
            "input_column_names":{
                "label":"response",
                "sample_id":"uid",
                "sample_weight":"weight",
                "feature_bag":"per_user"
            },
            "output_column_name":"predictionScore",
            "metadata_file":"movieLens/per_user/metadata/tensor_metadata.json",
            "l2_reg_weight":1.0,
            "regularize_bias":false,
            "num_partitions":1,
            "optimizer":{
                "optimizer_name":"LBFGS",
                "lbfgs_tolerance":1e-12,
                "num_of_lbfgs_iterations":100,
                "num_of_lbfgs_curvature_pairs":10
            },
            "max_training_queue_size":10,
            "num_of_consumers":1,
            "enable_local_indexing":false
        },
        {
            "name":"per-movie",
            "action":"train",
            "model_type":"logistic_regression",
            "partition_entity":"movie_id",
            "train_data_path":"movieLens/per_movie/trainingData",
            "validation_data_path":"movieLens/per_movie/validationData",
            "feature_file":"movieLens/per_movie/featureList/per_movie",
            "input_column_names":{
                "label":"response",
                "sample_id":"uid",
                "sample_weight":"weight",
                "feature_bag":"per_movie"
            },
            "output_column_name":"predictionScore",
            "metadata_file":"movieLens/per_movie/metadata/tensor_metadata.json",
            "l2_reg_weight":1.0,
            "regularize_bias":false,
            "num_partitions":1,
            "optimizer":{
                "optimizer_name":"LBFGS",
                "lbfgs_tolerance":1e-12,
                "num_of_lbfgs_iterations":100,
                "num_of_lbfgs_curvature_pairs":10
            },
            "max_training_queue_size":10,
            "num_of_consumers":1,
            "enable_local_indexing":false
        }
    ],
    "spark_config":{
        "num_cxecutor":2,
        "num_executor_core":1,
        "driver_memory_size":"1g",
        "executor_memory_size":"1g"
    },
    "tfjob_config":{
        "worker_type":"gpu",
        "need_chief":false,
        "num_ps":1,
        "num_evaluator":0,
        "num_worker":2,
        "memory_size":"1g"
    }
}
